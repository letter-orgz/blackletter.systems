id: 3.1
epic: 3
title: Findings Table (evidenceâ€‘first)
status: approved
story: |
  As a reviewer, I want to see a table of findings for an analyzed contract so that I can quickly understand which GDPR Article 28 clauses might be missing or weak.
acceptance_criteria:
  - 8 detector rows with verdict color and short rationale
  - Detail drawer shows snippet + rule id + copy button
  - Filter by verdict; search within snippets
notes:
  - Frontend component, likely using a table library (e.g., TanStack Table).
  - Verdict colors: pass (green), weak (yellow), missing (red), needs_review (orange).
  - Detail drawer should be accessible via click or expand icon.
  - Filtering and search should be client-side for MVP.
tasks: []
dev_agent_record:
  proposed_tasks:
    - api: Add GET /api/analyses/{id} and /findings endpoints
    - ui: Build Findings table with verdict filter + snippet search
    - ui: Evidence Drawer (snippet, rule id, offsets, copy)
    - a11y: Table semantics, aria labels on chips
    - tests: UI render tests with fixtures
  dependencies:
    - story: 2.2-detector-runner
  impl_notes:
    - Mock-driven UI scaffolding added under apps/web: table, drawer, verdict chips, empty-state text
    - Toggle mocks via NEXT_PUBLIC_USE_MOCKS=1; falls back to API stubs otherwise
    - Local-only 'Reviewed' badge toggle in drawer for UX validation

### dev_spec

- API: Consume `GET /api/analyses/{id}` and `/findings`; fallback to mocks when `NEXT_PUBLIC_USE_MOCKS=1`.
- UI: FindingsTable with verdict filter, snippet search, empty-state; EvidenceDrawer with rule id, offsets, copy button; VerdictChips with ARIA.
- A11y: Table semantics; keyboard-open/close drawer; ESC closes.

### qa_tests

- Render 8 rows and correct verdict chips; filter/search interactions.
- Drawer opens via keyboard/click; copy copies snippet; empty-state visible.
- A11y checks on table semantics and ESC behavior.
  status_notes:
    - Approved based on implemented UI in apps/web with mocks and passing a11y/unit tests.
    - API endpoints remain as a dependency and will be handled in corresponding backend stories.

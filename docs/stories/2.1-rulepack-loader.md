id: 2.1
epic: 2
title: Rulepack Loader (art28_v1)
status: draft
story: |
  As a system, I need to load and validate the GDPR Article 28 rulepack so that the detection engine can use these rules to analyze contracts.
acceptance_criteria:
  - Load YAML; validate schema; list detectors and lexicons
  - On invalid YAML, surface clear errors
  - Config: rules path env var; hotâ€‘reload disabled in prod
notes:
  - Rulepack file is `art28_v1.yaml`.
  - Lexicons are stored in `lexicons/` subdirectory.
  - Validation should check for required fields in rules/lexicons.
  - Loading should happen at application startup or via a specific admin action.
tasks: []
dev_agent_record:
  proposed_tasks:
    - backend: Implement services/rulepack_loader.py schema validation (YAML + lexicons)
    - backend: Cache loaded pack; env RULES_PATH; disable hot-reload in prod
    - api: Optional GET /api/admin/rules to expose name/version/detectors
    - tests: Invalid YAML, missing fields, unknown lexicon; happy path snapshot
  open_decisions:
    - Minimal schema (anchors_any/all/redflags_any) vs. extended (weights, windows)
    - Error surface level (startup fail vs. 500 on request)

### dev_spec

- Loader: `services/rulepack_loader.py` reads `RULES_PATH` (default `rules/art28_v1.yaml`), validates schema, loads `rules/lexicons/*`, caches in-memory; hot-reload disabled in prod.
- Schema: detector `{ id, name?, anchors_any[], anchors_all[], redflags_any[], weak_lexicon?, window? }`; lexicon YAML with `terms` list.
- API (optional): `GET /api/admin/rules` returns `{ name, version, detectors:[{id,name}], lexicons:[...] }`.

### qa_tests

- Invalid YAML and missing required fields produce clear errors.
- Unknown lexicon references flagged; happy path snapshot includes detector count and lexicon names.

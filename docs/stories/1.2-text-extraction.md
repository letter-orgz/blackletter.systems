id: 1.2
epic: 1
title: Text Extraction (PDF/DOCX)
status: draft
story: |
  As a system, I need to extract text, create a page map, and build a sentence index from uploaded PDF/DOCX files so that the detection engine can analyze the content.
acceptance_criteria:
  - Extract text → page map (page→char range) + sentence index
  - Store extraction artefacts linked to analysis record
  - Malformed/corrupt docs handled with explicit error codes
  - OCR default off; config flag enables OCR path
notes:
  - Use PyMuPDF for PDF, docx2python for DOCX as per tech stack.
  - Sentence splitting using blingfire.
  - Handle errors gracefully during extraction and persist error state.
tasks: []
dev_agent_record:
  proposed_tasks:
    - service: Implement extraction using PyMuPDF and docx2python
    - service: Build sentence index with blingfire
    - storage: Persist text, page map, and sentence index linked to analysis
    - config: Add OCR flag in configuration and handle OCR path
    - tests: Error handling for malformed documents

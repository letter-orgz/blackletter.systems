id: 0.0
epic: 3
title: Demo Mock Contract Flow
status: Draft
story: |
  As a user, I want to see a complete demo flow of the application (Dashboard -> Findings -> Export) using mock data so that I can understand the core functionality before the backend is fully implemented.
acceptance_criteria:
  - Dashboard shows a seeded item ACME_DPA_MOCK.pdf with verdict chips (Pass/Weak/Missing/Needs review). Clicking it navigates to `/analyses/mock-1`.
  - Findings page renders 8 detector rows (a–h) with verdict chips, rationale, and search/filter.
  - Evidence Drawer with highlighted anchors, page + char offsets, copy-to-clipboard, and a client-side Mark reviewed badge.
  - Export dialog opens from Findings header and allows: include logo, include metadata, choose date format. Confirming logs the selection (no backend call yet).
  - Reports list (stub) shows a placeholder ACME_DPA_MOCK latest export item after an export is initiated (mock list only).
  - Accessibility: keyboard tab order works, ESC closes drawer/dialog, chips have ARIA labels, contrast meets AA.
  - Toggle: Unsetting `NEXT_PUBLIC_USE_MOCKS` makes the UI fall back to the API stubs without errors.

dev_notes:
  Previous Story Insights:
  - No previous story.

  Data Models:
  - No specific backend data models are used in this mock story. Mock data structures will be created in the frontend.
  - The `Finding` model is mocked: `{ detector_id: string, rule_id: string, verdict: "pass"|"weak"|"missing"|"needs_review", snippet: string, page: number, start: number, end: number, rationale: string, reviewed: boolean }` [Source: docs/architecture/5-data-model-pydantic.md]

  API Specifications:
  - No real API endpoints are used. All data is mocked client-side. [Source: docs/architecture/6-api-contracts-mvp-frozen.md]

  Component Specifications:
  - Dashboard: List of mock contracts.
  - FindingsTable: Table displaying mock findings.
  - EvidenceDrawer: Drawer component showing detailed evidence for a finding.
  - ExportDialog: Modal dialog for export options.
  - VerdictChips: Reusable chip components for verdict display.
  - ReportsList (stub): List of mock export reports.
  [Source: docs/architecture/front-end-architecture.md]

  File Locations:
  - apps/web/src/app/dashboard/page.tsx (mock list & navigate)
  - apps/web/src/app/analyses/[id]/page.tsx (header with chips & Export button; table+drawer wiring)
  - apps/web/src/components/FindingsTable.tsx (filters/search/empty-state)
  - apps/web/src/components/EvidenceDrawer.tsx (anchor highlighting, copy, reviewed badge)
  - apps/web/src/components/VerdictChips.tsx (summary chips)
  - apps/web/src/components/ExportDialog.tsx (options)
  - apps/web/src/lib/mocks.ts (seeded findings + summary)
  - apps/web/src/lib/anchors.ts (detector -> anchor terms)
  [Source: docs/architecture/source_tree.md]

  Testing Requirements:
  - Unit (TS): Mock builders return 8 detectors with stable verdict mix. Anchor highlighting function wraps only intended phrases.
  - UI (manual or Playwright): Keyboard access (TAB/SHIFT+TAB), ESC on drawer/dialog. Filter by verdict and see empty-state row when filters exclude all. Export dialog option changes reflect in logged payload.
  - Non-functional: Demo renders < 2s on a baseline machine; interactions < 100ms.
  [Source: docs/architecture/10-quality-gates-testing.md]

  Technical Constraints:
  - The demo must be gated by the `NEXT_PUBLIC_USE_MOCKS` environment variable. [Source: docs/architecture/front-end-architecture.md]
  - Code should be formatted with ESLint and Prettier. [Source: docs/architecture/coding_standards.md]
  - Components should be built with React and TypeScript using shadcn/ui and Tailwind CSS. [Source: docs/architecture/front-end-architecture.md]

tasks:
  - [ ] Frontend: Dashboard - Ensure `/dashboard` lists the seeded ACME_DPA_MOCK.pdf item with verdict chips and navigates to `/analyses/mock-1`. (AC: 1)
  - [ ] Frontend: Findings - Keep page at `/analyses/[id]` working with id=`mock-1`. Evidence Drawer highlights detector-specific anchors; Mark reviewed toggles a local flag. (AC: 2, 3)
  - [ ] Frontend: Export - Export dialog appears in header; confirmation currently `console.log`s options. (AC: 4)
  - [ ] Frontend: Reports (stub) - Add `/reports` page that reads a local mock store and shows a single latest export entry when an export is confirmed in the dialog. (AC: 5)
  - [ ] Frontend: A11y - Verify ESC behavior (drawer & dialog), focus trap, ARIA labels on verdict chips, and visible focus rings. (AC: 6)
  - [ ] Frontend: Toggle - Ensure unsetting `NEXT_PUBLIC_USE_MOCKS` makes the UI fall back to the API stubs without errors. (AC: 7)
  - [ ] Docs: Add a Demo mode note in `apps/web/README.md` (how to enable/disable, what’s included). (AC: 1, 7)

change_log:
  - 2025-08-30: Story drafted by Scrum Master (Bob).
id: 1.3
epic: 1
title: Evidence Window Builder (±2 sentences)
status: Ready for Review
story: |
  As a detection system, I need to build evidence windows around findings so that reviewers can see the context of a detected issue within the contract text.
acceptance_criteria:
  - Given a char span, return ±2 sentences (configurable per detector)
  - Respect sentence boundaries; avoid cross‑page leakage
  - Unit tests with synthetic spans
notes:
  - Use the sentence index created in Story 1.2.
  - Need to handle edge cases like spans near the beginning or end of the document.
  - Configuration for sentence window size should be considered.
tasks: []
dev_agent_record:
  proposed_tasks:
    - service: Return ±N sentences around a char span using the sentence index
    - config: Make window size configurable per detector
    - service: Handle edge cases near document boundaries and page edges
    - tests: Spans at start, middle, and end of documents
  file_list:
    - "apps/api/blackletter_api/tests/unit/test_evidence_windows.py"
change_log:
  - date: '2025-08-29'
    version: '1.0'
    description: "Completed story by implementing unit tests for the existing service logic. All tests pass."
    author: "James (Developer)"

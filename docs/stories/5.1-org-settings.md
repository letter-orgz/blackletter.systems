id: 5.1
epic: 5
title: Org Settings (LLM/OCR/Retention)
status: draft
story: |
  As an administrator, I want to configure organization-level settings for LLM provider, OCR enablement, and data retention so that I can control costs, features, and compliance.
acceptance_criteria:
  - Toggle LLM provider (none/default), OCR, retention policy
  - Persist securely; defaults conservative
  - Audit log for settings changes
notes:
  - Settings should be loaded at application startup and potentially reloadable.
  - Secure persistence likely means environment variables or a secure configuration store.
  - Retention policy defines how long analysis data/files are kept.
  - Audit logging should capture who changed what and when.
tasks: []
dev_agent_record: {}

### dev_spec

- Model: `OrgSettings { llm_provider: 'none'|'openai'|..., ocr_enabled: bool, retention_days: int }`.
- Services: `services/settings.py` loads/saves `.data/settings/settings.json`; env overrides; audit log `.data/settings/audit.log`.
- API: `GET/PUT /api/admin/settings` with CSRF and admin guard.
- Integration: OCR flag in extraction (1.2); LLM provider influences token ledger and detector runner LLM paths; retention cleaner removes old analyses safely.

### qa_tests

- Roundtrip load/save with audit entries; defaults conservative.
- AuthZ + CSRF enforced; retention cleaner dry-run + real.
